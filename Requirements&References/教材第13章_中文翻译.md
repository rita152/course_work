![](_page_0_Picture_0.jpeg)

## 第13章

# **金融应用**

在本章中，我们将研究线性规划在定量金融问题中的一些应用。

## **1. 投资组合选择**

每个投资者，从个人到专业基金经理，都必须决定其投资组合中资产的适当组合。给定一组潜在投资（例如，从1到n索引），令 $R^j$ 表示投资j在下一个时间段的收益，$j = 1,...,n$。通常，$R^j$ 是一个随机变量，尽管某些投资可能本质上是确定性的。

**投资组合**是通过指定将资产的哪一部分投入到每项投资中来确定的。也就是说，投资组合是一组非负数 $x^j$，$j = 1,...,n$，其总和为1。使用给定投资组合获得的收益（每美元）由以下公式给出：

$$R = \sum_{j} x_{j} R_{j}.$$

与这样的投资组合相关的**回报**定义为期望收益$^1$：

$$\mathbb{E}R = \sum_{j} x_{j} \mathbb{E}R_{j}.$$

如果回报是唯一考虑的问题，那么问题将是微不足道的：只需将所有资金投入期望收益最高的投资即可。但不幸的是，具有高回报的投资通常也伴随着高水平的风险。也就是说，即使它们预计在长期内表现很好，但在短期内也往往是不稳定的。定义风险有很多方法，有些方法比其他方法更好。我们将**风险**

$$\mathbb{E}R = \frac{1}{T} \sum_{t=1}^{T} R(t).$$

$^1$ 在本章中，我们假设对概率的思想和符号有适度的熟悉：符号E表示**期望值**，这意味着，如果R是一个以相等概率取值 $R(1), R(2),...,R(T)$ 的**随机变量**，那么

<span id="page-1-0"></span>与投资（或者就此而言，投资组合）相关的风险定义为**均值绝对偏差（MAD）**：

$$\mathbb{E}|R - \mathbb{E}R| = \mathbb{E}\left|\sum_{j} x_{j}(R_{j} - \mathbb{E}R_{j})\right|$$
$$= \mathbb{E}\left|\sum_{j} x_{j}\tilde{R}_{j}\right|,$$

其中 $\tilde{R}_j = R_j - \mathbb{E} R_j$。人们希望在最大化回报的同时不承担过多的风险。每当面对两个（或更多）相互竞争的目标时，有必要考虑一系列可能的最优解，因为人们从主要关注一个目标转向另一个目标。在我们的投资组合选择问题中，我们形成回报和风险的线性组合（这里用 $\mu$ 参数化）并最大化它：

(13.1) 
$$\max \quad \mu \sum_{j} x_{j} \mathbb{E}R_{j} - \mathbb{E}\left|\sum_{j} x_{j} \tilde{R}_{j}\right|$$
 subject to 
$$\sum_{j} x_{j} = 1$$
 
$$x_{j} \geq 0 \qquad j = 1, 2, \dots, n.$$

在这里，$\mu$ 是一个正参数，表示风险相对于回报的重要性：$\mu$ 的高值倾向于最大化回报而不考虑风险，而低值则试图最小化风险。

重要的是要注意，通过多元化（即不将所有资金投入一项投资），可能可以在不降低回报的情况下降低风险。为了了解这是如何发生的，考虑涉及两项投资A和B的假设情况。每年，投资A要么上涨30％，要么下跌10％，但不幸的是，涨跌是不可预测的（即每年都独立于前几年，并且有1/2的概率是上涨年份）。投资B也非常不稳定。事实上，在A上涨30％的任何一年中，投资B都会下跌10％，而在A下跌10％的年份中，B会上涨30％。显然，通过将我们投资组合的一半投入A，一半投入B，我们可以创建一个每年无一例外上涨10％的投资组合。识别彼此负相关的投资（例如A和B）并在这些投资之间分配投资组合的行为称为**对冲**。不幸的是，很难找到具有强负相关性的投资对。但这种负相关性确实会发生。一般来说，当A和B的命运都依赖于一个共同的基础因素时，可以预期它们会发生。例如，炎热、无雨的夏天对能源有利，但对农业不利。

<span id="page-2-0"></span>

| 年-     | SHY   | XLB       | XLE    | XLF       | XLI     | XLK   | XLP     | XLU   | XLV    |
|---------|-------|-----------|--------|-----------|---------|-------|---------|-------|--------|
| 月      | 债券  | 材料      | 能源   | 金融      | 工业    | 科技  | 日用品  | 公用事业 | 医疗 |
| 2007-04 | 1.000 | 1.044     | 1.068  | 1.016     | 1.035   | 1.032 | 1.004   | 0.987 | 1.014  |
| 2007-03 | 1.003 | 1.015     | 1.051  | 1.039     | 1.046   | 1.047 | 1.028   | 1.049 | 1.073  |
| 2007-02 | 1.005 | 1.024     | 1.062  | 0.994     | 1.008   | 1.010 | 1.021   | 1.036 | 1.002  |
| 2007-01 | 1.007 | 1.027     | 0.980  | 0.971     | 0.989   | 0.973 | 0.985   | 1.053 | 0.977  |
| 2006-12 | 1.002 | 1.040     | 0.991  | 1.009     | 1.021   | 1.020 | 1.020   | 0.996 | 1.030  |
| 2006-11 | 1.001 | 0.995     | 0.969  | 1.030     | 0.997   | 0.989 | 1.020   | 0.999 | 1.007  |
| 2006-10 | 1.005 | 1.044     | 1.086  | 1.007     | 1.024   | 1.028 | 0.991   | 1.026 | 0.999  |
| 2006-09 | 1.004 | 1.060     | 1.043  | 1.023     | 1.028   | 1.040 | 1.018   | 1.053 | 1.003  |
| 2006-08 | 1.004 | 1.000     | 0.963  | 1.040     | 1.038   | 1.040 | 0.999   | 0.985 | 1.015  |
| 2006-07 | 1.008 | 1.030     | 0.949  | 1.012     | 1.011   | 1.070 | 1.039   | 1.028 | 1.029  |
| 2006-06 | 1.007 | 0.963     | 1.034  | 1.023     | 0.943   | 0.974 | 1.016   | 1.048 | 1.055  |
| 2006-05 | 1.002 | 1.005     | 1.022  | 0.995     | 0.999   | 0.995 | 1.018   | 1.023 | 1.000  |
| 2006-04 | 1.002 | 0.960     | 0.972  | 0.962     | 0.983   | 0.935 | 1.002   | 1.016 | 0.979  |
| 2006-03 | 1.002 | 1.035     | 1.050  | 1.043     | 1.021   | 0.987 | 1.010   | 1.016 | 0.969  |
| 2006-02 | 1.002 | 1.047     | 1.042  | 1.003     | 1.044   | 1.023 | 1.008   | 0.954 | 0.987  |
| 2006-01 | 1.000 | 0.978     | 0.908  | 1.021     | 1.031   | 1.002 | 1.008   | 1.013 | 1.012  |
| 2005-12 | 1.002 | 1.048     | 1.146  | 1.009     | 1.003   | 1.034 | 1.002   | 1.024 | 1.013  |
| 2005-11 | 1.004 | 1.029     | 1.018  | 1.000     | 1.005   | 0.969 | 1.001   | 1.009 | 1.035  |
| 2005-10 | 1.004 | 1.076     | 1.015  | 1.048     | 1.058   | 1.063 | 1.009   | 0.999 | 1.012  |
| 2005-09 | 0.999 | 1.002     | 0.909  | 1.030     | 0.986   | 0.977 | 0.996   | 0.936 | 0.969  |
| 2005-08 | 0.997 | 1.008     | 1.063  | 1.009     | 1.017   | 1.002 | 1.014   | 1.042 | 0.995  |
| 2005-07 | 1.007 | 0.958     | 1.064  | 0.983     | 0.976   | 0.991 | 0.983   | 1.006 | 0.996  |
| 2005-06 | 0.996 | 1.056     | 1.071  | 1.016     | 1.038   | 1.057 | 1.032   | 1.023 | 1.023  |
| 2005-05 | 1.002 | 0.980     | 1.070  | 1.012     | 0.974   | 0.987 | 0.981   | 1.059 | 0.994  |

表13.1. 九项投资在两年内的月收益率（每美元）。也就是说，2007年4月1日投资于能源板块基金XLE的1美元，在2007年4月30日价值1.068美元。

求解问题[\(13.1\)](#page-1-0)需要了解 $R^j$ 的联合分布。然而，这种分布在理论上是未知的，而必须通过查看历史数据来估计。例如，表13.1显示了一个债券基金（3年期国债）和八个不同板块指数基金在最近两年期间的月收益率：材料(XLB)、能源(XLE)、金融(XLF)、工业(XLI)、科技(XLK)、日用品(XLP)、公用事业(XLU)和医疗保健(XLV)。令 $R^j(t)$ 表示表13.1所示的T个月时间段内投资j的收益率。估计均值 $\mathbb{E}R^j$ 的一种方法是简单地取历史收益率的平均值：

$$\mathbb{E}R_j = \frac{1}{T} \sum_{t=1}^T R_j(t).$$

<span id="page-3-0"></span>**1.1. 转化为线性规划问题。** 如所述，(13.1)中的问题不是线性规划问题。我们使用与上一章中相同的技巧，用一个新变量替换每个绝对值，然后施加不等式约束，以确保一旦获得问题的最优值，新变量确实是适当的绝对值。但首先，让我们用简单的对给定历史数据的平均来重写(13.1)中的期望值操作：

(13.2) 
$$\max \quad \mu \sum_{j} x_{j} r_{j} - \frac{1}{T} \sum_{t=1}^{T} \left| \sum_{j} x_{j} (R_{j}(t) - r_{j}) \right|$$
 subject to 
$$\sum_{j} x_{j} = 1$$
 
$$x_{j} \geq 0 \qquad j = 1, 2, \dots, n,$$

其中

$$r_j = \frac{1}{T} \sum_{t=1}^{T} R_j(t)$$

表示资产j的期望回报。现在，将 $\left|\sum_j x_j (R_j(t) - r_j)\right|$ 替换为一个新变量 $y_t$，并将优化问题重写为

(13.3) 
$$\max \quad \mu \sum_{j} x_{j} r_{j} - \frac{1}{T} \sum_{t=1}^{T} y_{t}$$
 subject to 
$$-y_{t} \leq \sum_{j} x_{j} (R_{j}(t) - r_{j}) \leq y_{t} \qquad t = 1, 2, \dots, T,$$
 
$$\sum_{j} x_{j} = 1$$
 
$$x_{j} \geq 0 \qquad j = 1, 2, \dots, n$$
 
$$y_{t} > 0 \qquad t = 1, 2, \dots, T.$$

正如我们之前在其他情况下看到的，在最优性时，涉及 $y_t$ 的两个不等式之一必须实际上是等式，因为如果两个不等式都是严格的，那么可以通过减少 $y_t$ 来进一步增加目标函数。

**1.2. 通过参数单纯形法求解。** 由(13.3)给出的问题公式是一个线性规划，可以使用前面章节中描述的方法对任何特定的 $\mu$ 值求解。但是，我们可以做得更好。该问题是一个参数线性规划问题，其中参数是风险厌恶参数 $\mu$。如果我们能给出一个 $\mu$ 值，使得基本最优解是明显的，那么我们可以从这个基本解开始，使用参数单纯形法找到与每个 $\mu$ 值相关的最优解。很容易看出，对于大于某个阈值的 $\mu$，最优解是将我们的所有投资组合投入单个资产，即具有最高期望回报 $r_j$ 的资产。令 $j^*$ 表示这个最高回报资产：

$$r_{j^*} \ge r_j$$
 对所有 $j$ 成立。

我们需要将(13.3)写成字典形式。为此，让我们引入松弛变量 $w_t^+$ 和 $w_t^-$：

$$\begin{aligned} \text{maximize} \quad & \mu \sum_{j} x_{j} r_{j} - \frac{1}{T} \sum_{t=1}^{T} y_{t} \\ \text{subject to} \quad & -y_{t} - \sum_{j} x_{j} (R_{j}(t) - r_{j}) + w_{t}^{-} = 0 \qquad t = 1, 2, \dots, T, \\ & -y_{t} + \sum_{j} x_{j} (R_{j}(t) - r_{j}) + w_{t}^{+} = 0 \qquad t = 1, 2, \dots, T, \\ & \sum_{j} x_{j} = 1 \\ & x_{j} \geq 0 \qquad j = 1, 2, \dots, n, \\ & y_{t}, w_{t}^{+}, w_{t}^{-} \geq 0 \qquad t = 1, 2, \dots, T. \end{aligned}$$

我们有 $3T+n$ 个非负变量和 $2T+1$ 个等式约束。因此，我们需要找到 $2T+1$ 个基本变量和 $T+n-1$ 个非基本变量。由于我们知道每个配置变量的最优值，$x_{j^*}=1$ 而其余的 $x_j$ 消失，因此也很容易算出其他变量的值。然后我们可以简单地声明任何为正的变量为基本变量，并声明其余变量为非基本变量。根据这个规定，变量 $x_{j^*}$ 必须是基本的。其余的 $x_j$ 是非基本的。类似地，所有 $y_t$ 都非零，因此是基本的。对于每个 $t$，$w_t^-$ 或 $w_t^+$ 中的一个是基本的，另一个是非基本的。要说明哪个是哪个，我们需要引入一些额外的符号。令

$$D_{tj} = R_j(t) - r_j.$$

那么很容易检查，如果 $D_{tj^*} > 0$，则 $w_t^-$ 是基本的，如果 $D_{tj^*} < 0$，则 $w_t^+$ 是基本的（$D_{tj^*} = 0$ 的不太可能情况可以任意决定）。令

$$T^+ = \{t : D_{tj^*} > 0\}$$
和 $T^- = \{t : D_{tj^*} < 0\}$ 

并令

$$\epsilon_t = \begin{cases} 1, \text{ for } t \in T^+\\ -1, \text{ for } t \in T^-. \end{cases}$$

虽然繁琐，但这里是最优字典：

$$\zeta = \frac{1}{T} \sum_{t=1}^{T} \epsilon_{t} D_{tj^{*}} - \frac{1}{T} \sum_{j \neq j^{*}} \sum_{t=1}^{T} \epsilon_{t} (D_{tj} - D_{tj^{*}}) x_{j} - \frac{1}{T} \sum_{t \in T^{-}} w_{t}^{-} - \frac{1}{T} \sum_{t \in T^{+}} w_{t}^{+}$$

$$+ \mu r_{j^{*}} + \mu \sum_{j \neq j^{*}} (r_{j} - r_{j^{*}}) x_{j}$$

$$y_{t} = -D_{tj^{*}} - \sum_{j \neq j^{*}} (D_{tj} - D_{tj^{*}}) x_{j} + w_{t}^{-} \qquad t \in T^{-}$$

$$w_{t}^{-} = 2 D_{tj^{*}} + 2 \sum_{j \neq j^{*}} (D_{tj} - D_{tj^{*}}) x_{j} + w_{t}^{+} \qquad t \in T^{+}$$

$$y_{t} = D_{tj^{*}} + \sum_{j \neq j^{*}} (D_{tj} - D_{tj^{*}}) x_{j} + w_{t}^{+} \qquad t \in T^{+}$$

$$w_{t}^{+} = -2 D_{tj^{*}} - 2 \sum_{j \neq j^{*}} (D_{tj} - D_{tj^{*}}) x_{j} + w_{t}^{-} \qquad t \in T^{-}$$

$$x_{j^{*}} = 1 - \sum_{j \neq j^{*}} x_{j}.$$

我们现在可以检查，对于大的 $\mu$，这个字典是最优的。确实，目标函数第一行中 $w_t^-$ 和 $w_t^+$ 变量的目标系数是负的。第一行中 $x_j$ 的系数可以是正的或负的，但对于足够大的 $\mu$，第二行中 $x_j$ 的负系数占主导地位，使得考虑两行后所有系数都为负。类似地，所有基本变量为正这一事实直接从 $T^+$ 和 $T^-$ 的定义得出。

一些简单的不等式确定了给定字典最优的 $\mu$ 阈值。然后可以使用参数单纯形法系统地将 $\mu$ 减少到零。在此过程中，遇到的每个字典对应于某个 $\mu$ 值范围的最优解。因此，在一次遍历中，我们已经解决了从最勇敢到最谨慎的每个投资者的投资组合选择问题。图13.1显示了所有最优投资组合。可能的所有风险-回报概况集合显示在图13.2中。该集合的右下边界是所谓的**有效前沿**。产生不在有效前沿上的风险-回报组合的任何投资组合都可以通过增加其平均回报而不改变风险或通过减少风险而不改变平均回报来改进。因此，人们应该只投资于位于有效前沿上的投资组合。

